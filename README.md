# Opencv-PyTorch
Обнаружение объектов с веб-камеры с использованием YOLOv5
Этот проект позволяет выполнять обнаружение объектов в реальном времени с использованием веб-камеры и модели YOLOv5. Объекты обводятся прямоугольниками, а над ними указывается название класса и уровень уверенности.

Требования
Перед запуском убедитесь, что у вас есть:

Python:

Версия: Python 3.7 или выше (поддерживается Python 3.11).
Необходимые зависимости: Установите требуемые библиотеки Python с помощью команды:

bash
Копировать код
pip install torch torchvision opencv-python
Модель YOLOv5:

Скачайте предобученную модель YOLOv5 (например, yolov5n.pt или другую).
Поместите файл модели в директорию проекта и укажите путь к нему в коде:
python
Копировать код
model = torch.hub.load('ultralytics/yolov5', 'custom', path='C:\\Users\\Admin\\Desktop\\Ai_Opencv\\yolov5n.pt')
Веб-камера:

Убедитесь, что веб-камера подключена. Если у вас несколько камер, измените индекс в коде:
python
Копировать код
cap = cv2.VideoCapture(0)  # Замените '0' на '1' или другой индекс для других камер
Выходной видеофайл (опционально):

По умолчанию обработанное видео с результатами будет сохранено по следующему пути:
makefile
Копировать код
C:\\Users\\Admin\\Desktop\\Ai_Opencv\\webcam_output.avi
Вы можете изменить путь в коде:
python
Копировать код
output_video_path = 'C:\\Users\\Admin\\Desktop\\Ai_Opencv\\webcam_output.avi'
Как запустить
Клонируйте этот репозиторий или скопируйте код в локальный файл.

Убедитесь, что файл модели YOLOv5 (yolov5n.pt) находится в указанной директории.

Запустите скрипт:

bash
Копировать код
python your_script_name.py
Обнаружение объектов начнется в реальном времени. Для завершения работы нажмите q.

Объяснение кода
Загрузка модели:

YOLOv5 загружается через torch.hub.load. Убедитесь, что путь к .pt файлу модели указан правильно.
Захват видео с веб-камеры:

Веб-камера подключается через cv2.VideoCapture. Каждый кадр обрабатывается по очереди.
Обнаружение объектов:

Кадры передаются модели YOLOv5, которая возвращает результаты детекции.
Обвод объектов:

Обнаруженные объекты обводятся прямоугольниками (cv2.rectangle), а над ними выводится название класса и уровень уверенности (cv2.putText).
Сохранение видео (опционально):

Если включена запись, обработанные кадры сохраняются в выходной файл с помощью cv2.VideoWriter.
Вывод окна:

Обработанное видео отображается в отдельном окне в реальном времени.
Основные параметры
Путь к модели YOLOv5:

python
Копировать код
path='C:\\Users\\Admin\\Desktop\\Ai_Opencv\\yolov5n.pt'
Путь к выходному видео:

python
Копировать код
output_video_path = 'C:\\Users\\Admin\\Desktop\\Ai_Opencv\\webcam_output.avi'
Индекс камеры:

Для переключения между камерами измените индекс (по умолчанию 0):
python
Копировать код
cap = cv2.VideoCapture(0)
Распространенные ошибки
Камера не обнаружена:

Проверьте подключение камеры.
Попробуйте изменить индекс камеры (0, 1 и т.д.).
Файл модели YOLOv5 отсутствует:

Проверьте, что файл модели находится в указанной директории.
Не установлены зависимости:

Убедитесь, что установлены OpenCV и PyTorch:
bash
Копировать код
pip install torch torchvision opencv-python
